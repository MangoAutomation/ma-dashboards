<ul ng-include="'maTreeView.listItems.html'"></ul>

<script type="text/ng-template" id="maTreeView.listItems.html">
	<li ng-if="!context.childrenPromise && !context.children.length"><em ma-tr="ui.components.noItemsToList"></em></li>
	<li ng-if="context.childrenPromise"><em ma-tr="ui.components.loadingItems"></em></li>
    <li ng-repeat="item in context.children track by $ctrl.id(item)" ng-init="itemContext = $ctrl.newContext(item, context)">
		<span ng-if="itemContext.hasChildren" ng-click="itemContext.toggleChildren()">
        	<span ma-tree-view-transclude></span>
            <md-icon>{{itemContext.showChildren ? 'keyboard_arrow_up' : 'keyboard_arrow_down'}}</md-icon>
		</span>
		<span ng-if="!itemContext.hasChildren">
        	<span ma-tree-view-transclude></span>
		</span>

        <ul ng-if="itemContext.showChildren" ng-include="'maTreeView.listItems.html'" ng-init="context = itemContext"></ul>
    </li>
</script>