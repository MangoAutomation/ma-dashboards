<h3 ma-tr="eventHandlers.emailSettings"></h3>
<div layout layout-align="start center" layout-wrap>
    <div flex="100" flex-gt-md="33">
        <md-checkbox name="includeSystemInfo" ng-model="editor.eventHandler.includeSystemInfo"><span ma-tr="eventHandlers.includeSystemInfo"></span></md-checkbox>
    </div>
    
    <div flex="100" flex-gt-md="33">
        <md-checkbox name="includeLogfile" ng-model="editor.eventHandler.includeLogfile"><span ma-tr="eventHandlers.includeLogfile"></span></md-checkbox>
    </div>
    
    <md-input-container flex="100" flex-gt-md="33">
        <label ma-tr="eventHandlers.includePointValueCount"></label>
        <input name="includePointValueCount" ng-model="editor.eventHandler.includePointValueCount" min="0" step="1">
        <div ng-messages="editor.form.includePointValueCount.$error">
            <div ng-message="required" ma-tr="ui.app.required"></div>
            <div ng-message="validationMessage" ng-bind="editor.form.includePointValueCount.validationMessage"></div>
        </div>
    </md-input-container>
</div>

<h3 ma-tr="eventHandlers.emailRecipients"></h3>
<ma-email-recipients name="activeRecipients" ng-model="editor.eventHandler.activeRecipients" type-property="recipientType"></ma-email-recipients>

<h3 ma-tr="eventHandlers.escalationEmail"></h3>
<div>
    <md-checkbox name="sendEscalation" ng-model="editor.eventHandler.sendEscalation"><span ma-tr="eventHandlers.escal"></span></md-checkbox>
</div>
<div ng-if="editor.eventHandler.sendEscalation">
    <div>
        <md-checkbox name="repeatEscalations" ng-model="editor.eventHandler.repeatEscalations"><span ma-tr="eventHandlers.repeatEscal"></span></md-checkbox>
    </div>
    
    <div layout="100" flex-gt-md="50" layout-align="start center">
        <label for="escalationDelay" ma-tr="eventHandlers.escalPeriod"></label>
        <md-input-container>
            <input name="escalationDelay" ng-model="editor.eventHandler.escalationDelay" type="number" step="1">
        </md-input-container>
        <md-input-container>
            <ma-interval-type-picker name="escalationDelayType" ng-model="editor.eventHandler.escalationDelayType"></ma-interval-type-picker>
        </md-input-container>
    </div>
    
    <ma-email-recipients name="escalationRecipients" ng-model="editor.eventHandler.escalationRecipients" type-property="recipientType"></ma-email-recipients>
</div>

<h3 ma-tr="eventHandlers.inactiveEmail"></h3>
<div>
    <md-checkbox name="sendInactive" ng-model="editor.eventHandler.sendInactive"><span ma-tr="eventHandlers.inactiveNotif"></span></md-checkbox>
</div>

<div ng-if="editor.eventHandler.sendInactive">
    <div>
        <md-checkbox name="inactiveOverride" ng-model="editor.eventHandler.inactiveOverride"><span ma-tr="eventHandlers.inactiveOverride"></span></md-checkbox>
    </div>
</div>

<ma-email-recipients ng-if="editor.eventHandler.sendInactive && editor.eventHandler.inactiveOverride" type-property="recipientType" name="inactiveRecipients" ng-model="editor.eventHandler.inactiveRecipients"></ma-email-recipients>

<md-tab>
    <md-tab-label>
        <span ma-tr="eventHandlers.customTemplate"></span>
    </md-tab-label>
    <md-tab-body>
        <div class="md-padding ma-no-padding-bottom" id="email-template">
            <h3 ma-tr="eventHandlers.customTemplate"></h3>
            <ma-ace-editor name="customTemplate" mode="ftl" ng-model="editor.eventHandler.customTemplate"></ma-ace-editor>
             <!-- md input containers use warn-A700 -->
            <div ng-messages="editor.form.customTemplate.$error" role="alert" md-colors="::{color: 'warn'}">
                <div ng-message="validationMessage" ng-bind="editor.form.customTemplate.validationMessage"></div>
            </div>
        </div>
    </md-tab-body>
</md-tab>

<md-tab>
    <md-tab-label>
        <span ma-tr="eventHandlers.script"></span>
    </md-tab-label>
    <md-tab-body>
        <div layout="row" class="md-padding ma-no-padding-bottom">
            <md-input-container flex="100" flex-gt-md="50">
                <label ma-tr="users.permissions"></label>
                <input name="scriptPermissions" ng-model="editor.eventHandler.scriptPermissions" pattern="^\s*[\w-]+?\s*(,\s*[\w-]+?\s*)*$" ma-array-input>
                <div ng-messages="editor.form.scriptPermissions.$error">
                    <div ng-message="pattern" ma-tr="ui.app.invalidPermissions"></div>
                    <div ng-message="validationMessage" ng-bind="editor.form.permissions.validationMessage"></div>
                </div>
                <ma-permissions-menu ng-model="editor.eventHandler.scriptPermissions" ma-array-input></ma-permissions-menu>
            </md-input-container>
        </div>
        <div class="md-padding ma-no-padding-bottom">
            <h3 ma-tr="eventHandlers.script"></h3>
            <ma-scripting-editor name="script" ng-model="editor.eventHandler.script"></ma-scripting-editor>
        </div>
    </md-tab-body>
</md-tab>
