<md-input-container ng-if="!$ctrl.editMode && !$ctrl.selectMultiple" md-no-float="$ctrl.noFloat" flex>
    <label ng-if="!$ctrl.noFloat" ng-transclude="label"><span ma-tr="ui.components.selectTagKey"></span></label>
    <md-select ng-attr-md-selected-text="{{$ctrl.selectedText && '$ctrl.selectedText'}}"
            ng-model="$ctrl.selected" ng-change="$ctrl.inputChanged()" md-on-open="$ctrl.doQuery()">
        <md-option ng-repeat="value in $ctrl.values" ng-value="value" ng-disabled="$ctrl.disabledOptionsMap[value]">
            <span ng-bind="value"></span>
        </md-option>
    </md-select>
</md-input-container>

<md-input-container ng-if="!$ctrl.editMode && $ctrl.selectMultiple" md-no-float="$ctrl.noFloat" flex>
    <label ng-if="!$ctrl.noFloat" ng-transclude="label"><span ma-tr="ui.components.selectTagKey"></span></label>
    <md-select ng-attr-md-selected-text="{{$ctrl.selectedText && '$ctrl.selectedText'}}"
            multiple="true" ng-model="$ctrl.selected" ng-change="$ctrl.inputChanged()" md-on-open="$ctrl.doQuery()">
        <md-option ng-repeat="value in $ctrl.values" ng-value="value" ng-disabled="$ctrl.disabledOptionsMap[value]">
            <span ng-bind="value"></span>
        </md-option>
    </md-select>
</md-input-container>

<md-button ng-if-start="$ctrl.editMode" ng-disabled="!$ctrl.searchText" class="md-icon-button ma-small-button" ng-click="$ctrl.enterPressed()">
    <md-icon>add</md-icon>
    <md-tooltip><span ma-tr="ui.components.addTagKey"></span></md-tooltip>
</md-button>

<md-autocomplete ng-if-end flex
        md-selected-item="$ctrl.selected"
        md-selected-item-change="$ctrl.inputChanged()"
        md-search-text="$ctrl.searchText"
        md-search-text-change="$ctrl.searchTextChanged()"
        md-items="value in $ctrl.doSearch()"
        md-item-text="value"
        md-no-cache="::true"
        md-min-length="0"
        md-floating-label="{{$ctrl.labelText || ('ui.components.addTagKey' | maTr)}}"
        md-delay="0"
        md-select-on-match="::false"
        md-escape-options="blur"
        md-clear-button="::true"
        ng-blur="$ctrl.autocompleteBlurred()"
        ma-enter="$ctrl.enterPressed()">
    <md-item-template>
        <span md-highlight-text="$ctrl.searchText" md-highlight-flags="gi">{{value}}</span>
    </md-item-template>
</md-autocomplete>
