<md-toolbar class="md-whiteframe-1dp md-hue-3">
    <div class="md-toolbar-tools">
        <md-button class="watch-list-back md-icon-button" ng-click="$ctrl.clearWatchList()" ng-if="!$ctrl.$mdMedia('gt-md')"><md-icon>arrow_back</md-icon></md-button>
        <h2><span ng-bind="$ctrl.watchList.name" ng-if="$ctrl.$mdMedia('gt-md')"></span></h2>
        
        <div flex></div>
        
        <md-button class="md-primary md-raised" ng-click="$ctrl.saveSettings()">
            <md-icon>save</md-icon>
            <span ma-tr="common.save"></span>
        </md-button>
        <md-button class="md-raised" ui-sref="ui.settings.watchListBuilder({watchListXid: $ctrl.watchList.xid})" ng-if="!$ctrl.watchList.isNew">
            <md-icon>edit</md-icon>
            <span ma-tr="common.edit"></span>
        </md-button>
        <md-button class="md-raised" ng-click="$ctrl.showDownloadDialog($event)">
            <md-icon>file_download</md-icon>
            <span ma-tr="common.download"></span>
        </md-button>
        
        <md-button class="md-icon-button" ng-class="{'md-accent': $ctrl.selectColumnToolbarOpen}" ng-click="$ctrl.selectColumnToolbarOpen = !$ctrl.selectColumnToolbarOpen">
            <md-icon>{{$ctrl.selectColumnToolbarOpen ? 'keyboard_arrow_up' : 'keyboard_arrow_down'}}</md-icon>
            <md-tooltip>
                <span ma-tr="ui.app.selectColumns"></span>
            </md-tooltip>
        </md-button>
    </div>
</md-toolbar>
<md-toolbar class="md-hue-2" ng-show="$ctrl.selectColumnToolbarOpen">
    <div class="md-toolbar-tools">
        <div flex></div>

        <md-input-container md-no-float="true">
            <md-select md-selected-text="'ui.app.selectColumns' | maTr" multiple="true" ng-model="$ctrl.selectedColumns" ng-model-options="{trackBy: '$value.name'}">
                <md-option ng-repeat="column in $ctrl.columns track by column.name" ng-value="column"><span ma-tr="{{column.label}}"></span></md-option>
            </md-select>
        </md-input-container>
        
        <md-input-container md-no-float="true">
            <md-select md-selected-text="'ui.app.selectTags' | maTr" multiple="true" ng-model="$ctrl.selectedTags" ng-change="$ctrl.selectedTagsChanged()" ng-model-options="{trackBy: '$value.name'}">
                <md-option ng-repeat="tag in $ctrl.availableTags track by tag.name" ng-value="tag"><span ng-bind="tag.label"></span></md-option>
            </md-select>
        </md-input-container>
    </div>
</md-toolbar>

<ma-watch-list-parameters ng-if="$ctrl.watchList.hasParamOptions()" watch-list="$ctrl.watchList"
    ng-model="$ctrl.watchListParams" ng-change="$ctrl.getPoints()"
	class="parameter-inputs md-padding" layout layout-wrap>
</ma-watch-list-parameters>

<md-table-container ng-class="{'lg-screen': $ctrl.$mdMedia('gt-lg')}">
    <table md-table md-row-select multiple ng-model="$ctrl.selected"
            md-progress="$ctrl.pointsPromise" ng-class="{'desktop': $ctrl.$mdMedia('gt-sm')}" class="watch-list-table">
        <thead md-head md-order="$ctrl.tableOrder">
            <tr md-row>
                <th md-column md-order-by="deviceName" ma-tr="ui.app.device"></th>
                <th md-column md-order-by="name" ma-tr="ui.app.name"></th>
                <th md-column md-order-by="value" ma-tr="ui.app.value"></th>
                <th md-column md-order-by="time" ma-tr="ui.app.time"></th>
            </tr>
        </thead>
        <tbody md-body>
            <tr ng-repeat="point in $ctrl.points | orderBy: $ctrl.tableOrder | limitTo: $ctrl.numberOfRows: ($ctrl.pageNumber - 1) * $ctrl.numberOfRows"
                md-select="point" md-row md-select-id="xid"
                md-on-select="$ctrl.selectedPointsChangedBound"
                md-on-deselect="$ctrl.selectedPointsChangedBound">
                    <td md-cell ng-bind="point.deviceName"></td>
                    <td md-cell ng-bind="point.name"></td>
                    <td md-cell class="point-value">
                      <ma-point-value
                          point="point"
                          flash-on-change="true"
                          enable-popup="right">
                      </ma-point-value>
                    </td>
                    <td md-cell class="point-time">
                        <ma-point-value
                            point="point"
                            flash-on-change="true"
                            display-type="dateTime"
                            same-day-date-time-format="timeSeconds"
                            hide-event-indicator="true">
                        </ma-point-value>
                    </td>      
            </tr>
        </tbody>
    </table>
</md-table-container>

<md-table-pagination md-limit="$ctrl.numberOfRows" md-limit-options="[10, 15, 25, 50, 100, 200]" md-page="$ctrl.pageNumber" md-page-select md-total="{{$ctrl.points.length}}"></md-table-pagination>
