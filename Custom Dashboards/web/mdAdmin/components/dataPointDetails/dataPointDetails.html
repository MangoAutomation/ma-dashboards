<div layout="column" ng-init="page={}" class="data-point-details-page">
	<div flex layout="column" layout-gt-sm="row">
		<ma-point-values point="myPoint" values="myPointValues" from="$ctrl.dateBar.from" to="$ctrl.dateBar.to" rollup="{{$ctrl.dateBar.rollupType}}"
	      rollup-interval="{{$ctrl.dateBar.rollupInterval}} {{$ctrl.dateBar.rollupIntervalType}}" auto-rollup-interval="$ctrl.dateBar.autoRollup">
	    </ma-point-values>

		<md-card flex class="dpd-small-card">
			<md-toolbar class="md-whiteframe-1dp md-hue-3">
				<div class="md-toolbar-tools" ng-class="{'mobile': $mdMedia('xs')}">
					<h2 flex>
		              <span>Data Point: {{myPoint.deviceName}} - {{myPoint.name}}</span>
			        </h2>
				</div>
			</md-toolbar>
			<md-card-content layout="column">
				<md-input-container class="no-errors-spacer">
					<label>Choose a point</label>
					<ma-filtering-point-list ng-model="myPoint" auto-init="true" point-xid="{{$ctrl.pointXid}}"></ma-filtering-point-list>
				</md-input-container>
				<div layout="row" layout-wrap class="point-details">
					<label flex="35">XID:</label> <div flex="65" ng-bind="myPoint.xid"></div>
					<label flex="35">Value:</label> <ma-point-value flex="65" point-xid="{{$ctrl.pointXid}}" point="myPoint"></ma-point-value>
					<label flex="35">Time:</label> <ma-point-value flex="65" point="myPoint" display-type="dateTime" date-time-format="l LTS"></ma-point-value>
					<label flex="35">Source:</label> <div flex="65" ng-bind="myPoint.dataSourceName"></div>
					<label flex="35">Path:</label>  <div flex="65"><span ng-repeat="folder in $ctrl.path">{{folder}} <span ng-if="!$last"> &gt; </span></span></div>
					<div flex="65">
						<!-- <ma-point-hierarchy></ma-point-hierarchy> -->
					</div>
				</div>
				<br />
				<div layout="row">
					<ma-set-point-value point="myPoint" flex="95"></ma-set-point-value>
					<md-button class="md-accent md-raised" ng-href="{{'/data_point_edit.shtm?dpid=' + myPoint.id}}" target="_blank">edit</md-button>
				</div>
			</md-card-content>
		</md-card>
		
		<md-card flex class="dpd-small-card">
			<md-toolbar class="md-whiteframe-1dp md-hue-3">
				<div class="md-toolbar-tools" ng-class="{'mobile': $mdMedia('xs')}">
					<h2 flex>
			              <span>Point Value History</span>
			        </h2>
				</div>
			</md-toolbar>
			<md-table-container ng-init="myOrder='-timestamp'">
				<table md-table>
					<thead md-head md-order="myOrder">
						<tr md-row>
							<th md-column md-order-by="timestamp">TimeStamp</th>
							<th md-column md-order-by="value">Point Value</th>
						</tr>
					</thead>
					<tbody md-body>
						<tr md-row ng-repeat="value in myPointValues | orderBy: myOrder">
							<td md-cell>{{value.timestamp | moment:'format':'l LTS'}}</td>
							<td md-cell>{{value.value}}</td>
						</tr>
					</tbody>
				</table>
			</md-table-container>
		</md-card>
	</div>
	
	<div flex layout="column" layout-gt-sm="row">
		<md-card flex class="dpd-small-card">
			<md-toolbar class="md-whiteframe-1dp md-hue-3">
				<div class="md-toolbar-tools" ng-class="{'mobile': $mdMedia('xs')}">
					<h2 flex>
			              <span>Point Statistics</span>
			        </h2>
				</div>
			</md-toolbar>
			<ma-point-statistics point="myPoint" from="$ctrl.dateBar.from" to="$ctrl.dateBar.to" statistics="statsObj"></ma-point-statistics>
			<ma-statistics-table statistics="statsObj"></ma-statistics-table>
			<br />
		</md-card>
		
		<ma-user-notes-table reference-id="myPoint.id" flex class="dpd-small-card"></ma-user-notes-table>	
	</div>
    

	
	<md-card flex>
		<md-toolbar class="md-whiteframe-1dp md-hue-3">
			<div class="md-toolbar-tools" ng-class="{'mobile': $mdMedia('xs')}">
				<h2 flex>
					  <span>Chart</span>
				</h2>
				<md-select ng-model="chartType" ng-init="chartType='smoothedLine'" aria-label="Chart Type">
					<md-option value="smoothedLine">
						Smooth
					</md-option>
					<md-option value="line">
						Line
					</md-option>
					<md-option value="step">
						Step
					</md-option>
					<md-option value="column">
						Bar
					</md-option>
				</md-select>
			</div>
		</md-toolbar>
		<ma-serial-chart style="width: 100%" series-1-values="myPointValues" series-1-point="myPoint" legend="true" balloon="true" export="true" default-type="{{chartType}}">
		</ma-serial-chart>
	</md-card>

	<md-card flex>
		<md-toolbar class="md-whiteframe-1dp md-hue-3">
			<div class="md-toolbar-tools" ng-class="{'mobile': $mdMedia('xs')}">
				<h2 flex>
					  <span>Point Events</span>
				</h2>
			</div>
		</md-toolbar>
		<ma-events-table point-id="myPoint.id" limit="500" paginate-limit="5" from="$ctrl.dateBar.from" to="$ctrl.dateBar.to"></ma-events-table>
	</md-card>
</div>