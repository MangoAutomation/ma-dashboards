<md-toolbar class="md-whiteframe-glow-z1 md-hue-2 date-bar"
ng-class="{'two-rows': $ctrl.stateParams.dateBar.rollupControls || $ctrl.mdMedia('sm'), 'three-rows': ($ctrl.stateParams.dateBar.rollupControls && $ctrl.mdMedia('sm')) || $ctrl.mdMedia('xs'), 
'four-rows': $ctrl.stateParams.dateBar.rollupControls && $ctrl.mdMedia('xs')}">
  <div class="md-toolbar-tools" layout layout-align="center center">
    <div flex layout="column" layout-gt-sm="row" ng-form="$ctrl.form" layout-align="space-between start" flex-order="5" flex-order-gt-sm="-5">
      
      <div layout="column" flex="noshrink" layout-align="start start">
        <div flex layout layout-align="start center" ng-if="$ctrl.params.preset">
          <md-input-container  flex="40">
            <label ma-tr="dashboards.v3.app.updateIntervals"></label>
            <input name="updateIntervals" ng-model="$ctrl.params.updateIntervals" type="number" min="1" step="1"
                ng-disabled="!$ctrl.params.autoUpdate" ng-change="$ctrl.calcUpdateIntervalString()">
          </md-input-container>
          <md-input-container flex="40">
            <label ma-tr="dashboards.v3.app.updateUnit"></label>
            <md-select name="updateIntervalPeriod" ng-model="$ctrl.params.updateIntervalPeriod"
                ng-disabled="!$ctrl.params.autoUpdate" ng-change="$ctrl.calcUpdateIntervalString()">
              <md-option ng-repeat="t in $ctrl.timePeriodTypes track by t.type" ng-value="t.type" ng-bind="t.label"></md-option>
            </md-select>
          </md-input-container>
          <md-checkbox name="autoUpdate" flex="20" class="checkbox-top-label checkbox-centered" ng-model="$ctrl.params.autoUpdate"
              ng-change="$ctrl.calcUpdateIntervalString()">
            <span ma-tr="dashboards.v3.app.autoUpdate"></span>
          </md-checkbox>
        </div>
        
        <div flex layout layout-align="start center" ng-if="$ctrl.stateParams.dateBar.rollupControls">
          <md-input-container  flex="40">
            <label ma-tr="dashboards.v3.app.rollupIntervals"></label>
            <input name="rollupIntervals" ng-model="$ctrl.params.rollupIntervals" type="number" min="1" step="1"
                ng-disabled="$ctrl.params.rollupType === 'NONE' || $ctrl.params.autoRollup" ng-change="$ctrl.updateIntervalFromRollupInterval()">
          </md-input-container>
          <md-input-container flex="40">
            <label ma-tr="dashboards.v3.app.rollupUnit"></label>
            <md-select name="rollupIntervalPeriod" ng-model="$ctrl.params.rollupIntervalPeriod"
                ng-disabled="$ctrl.params.rollupType=='NONE' || $ctrl.params.autoRollup"
                ng-change="$ctrl.updateIntervalFromRollupInterval()">
              <md-option ng-repeat="t in $ctrl.timePeriodTypes track by t.type" ng-value="t.type" ng-bind="t.label"></md-option>
            </md-select>
          </md-input-container>
          <md-checkbox name="autoRollup" flex="20" class="checkbox-top-label checkbox-centered" ng-model="$ctrl.params.autoRollup"
              ng-disabled="$ctrl.params.rollupType === 'NONE'" ng-change="$ctrl.calcAutoRollup()">
            <span ma-tr="dashboards.v3.app.autoRollup"></span>
          </md-checkbox>
          <md-input-container flex="30" style="margin-left:15px">
            <label ma-tr="dashboards.v3.app.rollupType"></label>
            <md-select name="rollupType" ng-model="$ctrl.params.rollupType">
              <md-option ng-repeat="t in $ctrl.rollupTypes | filter:$ctrl.params.rollupTypesFilter track by t.type" ng-value="t.type" ng-bind="t.label"></md-option>
            </md-select>
          </md-input-container>
        </div>
      </div>
      

      <div layout flex="nogrow" layout-align="start center" layout-align-gt-sm="end center" layout-wrap flex-order="-5" flex-order-gt-sm="5" class="date-bar-date-pickers">
        <div flex="85" flex-gt-xs="40" flex-gt-md="30" flex-order="-5" layout layout-align="start center">
          <md-input-container flex="50" >
            <label ma-tr="dashboards.v3.app.fromDate"></label>
            <ma-date-picker name="fromDate" ng-model="$ctrl.params.from" mode="date"></ma-date-picker>
          </md-input-container>
          <md-input-container flex="50" >
            <label ma-tr="dashboards.v3.app.fromTime"></label>
            <ma-date-picker name="fromTime" ng-model="$ctrl.params.from" mode="time"></ma-date-picker>
          </md-input-container>
        </div>

        <div flex="85" flex-gt-xs="40" flex-gt-md="30" flex-order="5" flex-order-gt-xs="0" layout layout-align="start center">
          <md-input-container flex="50" >
            <label ma-tr="dashboards.v3.app.toDate"></label>
            <ma-date-picker name="toDate" ng-model="$ctrl.params.to" mode="date"></ma-date-picker>
          </md-input-container>
          <md-input-container flex="50" >
            <label ma-tr="dashboards.v3.app.toTime"></label>
            <ma-date-picker name="toTime" ng-model="$ctrl.params.to" mode="time"></ma-date-picker>
          </md-input-container>
        </div>
        
        <md-button flex="10" flex-gt-md="5" flex-order="0" flex-order-gt-xs="5" class="md-icon-button" ng-click="$ctrl.onRefresh({'$event': $event})" aria-label="{{'common.refresh' | tr}}" ng-disabled="!$ctrl.params.preset">
          <md-icon>refresh</md-icon>
        </md-button>
      </div>
      
    </div>
  </div>
</md-toolbar>