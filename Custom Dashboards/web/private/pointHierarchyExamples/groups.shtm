<!DOCTYPE html>

<html>
<head>
	<meta charset="utf-8">
	
	<!-- Page Style -->
    <style type="text/css">
    </style>
	
	
	<title>Inputs</title>
    
    <link rel="stylesheet" href="/modules/dashboards/web/js/jquery-mobile/jquery.mobile-1.4.4.min.css">
    <link rel="stylesheet" href="/modules/dashboards/web/js/joseph/jqm-demos.css">
        
    <!-- JQuery -->
    <script type="text/javascript" src="/modules/dashboards/web/js/jquery/jquery-1.11.1.js"></script>    	

	<!-- JQuery Mobile -->
	<script src="/modules/dashboards/web/js/jquery-mobile/jquery.mobile-1.4.4.min.js"></script>
       
    <link href="/modules/dashboards/web/js/jquery-ui/jquery.datetimepicker.css" rel="stylesheet">
 
    <script type="text/javascript" src="/modules/dashboards/web/js/jquery-ui/jquery.datetimepicker.js"></script>
    <!-- Charting Library -->
    <script type="text/javascript" src="/modules/dashboards/web/js/amcharts/amcharts.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/amcharts/serial.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/amcharts/gauge.js"></script>

    <!-- Mango Rest API Helper -->
    <script type="text/javascript" src="/modules/dashboards/web/js/mangoApi.js"></script>         
        
    <!-- Mango Templating API -->
    <!-- Display Widgets -->
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/serialChart.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/barChart.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/statisticsBarChart.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/pieChart.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/statistics.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/gaugeChart.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/simpleDisplay.js"></script>
    
    
    <!-- Data Providers -->
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/pointValueDataProvider.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/realtimePointValueDataProvider.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/statisticsDataProvider.js"></script>
    <!-- Templater Core -->
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/dataDisplayManager.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/dataPointMatcher.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/dataPointGroup.js"></script>  
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/pointHierarchyGrouper.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/dashboardTemplater.js"></script>
    <!-- Input Widgets -->
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/dateTimePicker.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/rollupPicker.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/timePeriodTypePicker.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/input.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/select.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/listView.js"></script>
    

   <script type="text/javascript">
   
   //Globally Define our Inputs
   var group1Select, group2List, group3Table;
   
   var groupsArray = new Array(); //Global Array for all matched Groups
   
   //Wait for document to fully load before using Grouper
   $( document ).ready(function(){
       
       //Define our 3 Groupers
       var grouper1, grouper2, grouper3;
       
       
       
       //Setup Point Configurations
       var pointConfigurations = new Array();
       pointConfigurations.push(new DataPointMatchConfiguration(1, {xidEndsWith: 'voltage'}))

       //Setup Group 1
       var group1 = new DataPointGroupConfiguration({
           groupBy: 'Folder',
           labelAttribute: 'name',
           matchConfigurations: [{
               matchAttribute: 'path',
               startsWith: 'Target Folder'
           }]
           });
       //Setup Group 1 Select
       group1Select = new SelectConfiguration('group1', {onGroup: onGroup1Change});
       
       //Make a REST API Call to get the Point Hierarchy and Create the Groupers
       var deferred = mangoRest.hierarchy.getRoot(function(phRoot){
           grouper1 = new PointHierarchyGrouper(phRoot, [group1], onGroup1);
           grouper1.group(); //Action the grouper to find the groups
           
           
       },showError);
            
   });// End When page Ready

   /**
    * Called by Grouper 1 When a group is matched
    */
   function onGroup1(dataPointGroup){
       //Add the group to our Groups Array
       group1Select.addItem(dataPointGroup.label, groupsArray.length);
       groupsArray.push(dataPointGroup);
   }
   function onGroup1Changed(value){
       alert('Group 1 Selected' + groupsArray[value]);
   }
   
   /**
    * Display Errors method
    */
   function showError(jqXHR, textStatus, errorThrown, mangoMessage){
       
       var msg = "";
       if(textStatus != null)
           msg += (textStatus + " ");
       if(errorThrown != null)
           msg += (errorThrown + " ");
       if(mangoMessage != null)
           msg += (mangoMessage + " ");
       msg += "\n";
       $("#errors").text(msg);
   }
   
   </script>





</head>
<body>
    <div id="errors"></div> <!-- Where we will put our errors -->
    
    <p>This page uses the Point Hierarchy Grouper to show different ways to create groups of data points.</p>
    <h2>Group 1</h2>
    <select id="group1">
        <option>Select Group</option>
    </select>
    
    <h2>Group 2</h2>
    <ul id="group2">
    </ul>
    
    <h2>Group 3</h2>
    <table>
	    <thead>
	       <tr>
	         <th>xid</th>
	         <th>Name</th>
	         <th>Device Name</th>
	         <th>Units</th>
	         <th>Enabled</th>
	       </tr>
	     </thead>
	     <tbody id="group3">
	     </tbody>
    </table>    
</body>
</html>

