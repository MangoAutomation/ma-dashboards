<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Meters</title>
    
    
    <link rel="stylesheet" href="/modules/dashboards/web/js/jquery-mobile/jquery.mobile-1.4.4.min.css">
    <link rel="stylesheet" href="/modules/dashboards/web/js/joseph/jqm-demos.css">
    <link rel="stylesheet" href="/modules/dashboards/web/private/css/collegeMobile.css">
    <!-- JQuery -->
    <script type="text/javascript" src="/modules/dashboards/web/js/jquery/jquery-1.11.1.js"></script>    	

    <!-- Joseph Page -->
    <script src="/modules/dashboards/web/js/joseph/index.js"></script>

    <!-- JQuery Mobile -->
    <script src="/modules/dashboards/web/js/jquery-mobile/jquery.mobile-1.4.4.min.js"></script>

    <link href="/modules/dashboards/web/js/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/modules/dashboards/web/js/jquery-ui/jquery.datetimepicker.css" rel="stylesheet">
    <link href="/modules/dashboards/web/private/css/dashboard.css" rel="stylesheet">
	
    <script type="text/javascript" src="/modules/dashboards/web/js/jquery-ui/jquery.datetimepicker.js"></script>
    <!-- Charting Library -->
    <script type="text/javascript" src="/modules/dashboards/web/js/amcharts/amcharts.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/amcharts/serial.js"></script>

    <script type="text/javascript" src="/modules/dashboards/web/js/amcharts/pie.js"></script>
        <script type="text/javascript" src="/modules/dashboards/web/js/amcharts/gauge.js"></script>



    <!-- Bootstrap -->
    <script src="/modules/dashboards/web/js/bootstrap/js/bootstrap.min.js"></script>
    
    
    <!-- Mango Rest API Helper -->
    <script type="text/javascript" src="/modules/dashboards/web/js/mangoApi.js"></script>         
    
    <!-- Mango AM Charts Helper -->
    <script type="text/javascript" src="/modules/dashboards/web/js/mangoAmChartsApi.js"></script>
        
    <!-- MangoJS -->
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/dataDisplayManager.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/serialChart.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/barChart.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/statisticsBarChart.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/pieChart.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/statistics.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/pointValueDataProvider.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/statisticsDataProvider.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/dataPointMatcher.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/dataPointGroup.js"></script>  
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/pointHierarchyGrouper.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/dashboardTemplater.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/dateTimePicker.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/rollupPicker.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/timePeriodTypePicker.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/input.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/select.js"></script>
    <script type="text/javascript" src="/modules/dashboards/web/js/mango/listView.js"></script>
    
    
    

   <script type="text/javascript">
    /*
    * setting up the global var for the templater so that we can use in things like listviews and other widgets that are from custom classes
    */
    var templater;
   
   
    /*
    * Fires when the everything is ready to show
    */
   $( document ).ready(function(){

    /**
    *Here is the Array that is used to push charts and other widgets to the DisplayManger
    */
       var displayConfigurations = new Array();
       
       
       var kwhChart = new  SerialChartConfiguration(
               'kwhChartDiv', //Chart DIV id
               /*
               * List of data provider Ids for this chart
               */
               [1],
               { //AmChart Mixins
           titles: [{
               id: "Title-1",
               size: 15,
               text: "KWH"

           }],
           categoryField: "timestamp",
           color: "whitesmoke",
					"startEffect": "bounce",

           graphs: [{
               title: "Kilo watts per hour",
               valueAxis: "kwh-axis",
               
               //Function to render the text inside the balloons
               //TODO Make this bulletproof and create a way to get a default 'graph'
               balloonFunction: function(graphDataItem, amGraph){
                   if(typeof graphDataItem.values != 'undefined'){
                       return graphDataItem.category + "<br>" + graphDataItem.values.value.toFixed(2);
                   }else{
                       return "";
                   }
               },
               
               bullet: "square",
               bulletSize: 6,
               lineColor: "green",
               lineThickness: 1,
               negativeLineColor: "red",
               type: "smoothedLine",
               valueField: "value"
           }],
           valueAxes: [{
               id: "kwh-axis",
               title: " KWH ",
               position: "left"
           }],
       });
       displayConfigurations.push(kwhChart);




        /**
        *AMPS Line Chart
        */
       var ampsChart = new  SerialChartConfiguration(
               /**
               * The Chart Id that is given to pass on to html
               */
               'ampsChartDiv', //Chart DIV id
               /*
               * List of data provider Ids for this chart
               */
               [2,3,4],
               /**
               * Start AmChart Styling
               */
               {
           titles: [{
               id: "Title-1",
               size: 15,
               text: "Amps "
           }],
           categoryField: "timestamp",
           color: "whitesmoke",
           "startEffect": "bounce",
           graphs: [{
               title: "Amps Phase A",
               valueAxis: "phaseA-axis",
               /*
               *Function to render the text inside the balloons
               */
               //TODO Make this bulletproof and create a way to get a default 'graph'
               balloonFunction: function(graphDataItem, amGraph){
                   if(typeof graphDataItem.values != 'undefined'){
                       return graphDataItem.category + "<br>" + graphDataItem.values.value.toFixed(2);
                   }else{
                       return "";
                   }
               },
               bullet: "square",
               bulletSize: 6,
               lineColor: "green",
               lineThickness: 1,
               negativeLineColor: "red",
               type: "smoothedLine",
               valueField: "phaseA"
           },{              
               title: "Amps Phase B",
               valueAxis: "phaseB-axis",
               /**
               *Function to render the text inside the balloons
               */
               //TODO Make this bulletproof and create a way to get a default 'graph'
               balloonFunction: function(graphDataItem, amGraph){
                   if(typeof graphDataItem.values != 'undefined'){
                       return graphDataItem.category + "<br>" + graphDataItem.values.value.toFixed(2);
                   }else{
                       return "";
                   }
               },
               bullet: "round",
               bulletSize: 6,
               lineColor: "red",
               lineThickness: 1,
               negativeLineColor: "red",
               type: "smoothedLine",
               valueField: "phaseB"
           },{              
               title: "Amps Phase C",
               valueAxis: "phaseC-axis",
               /**
               *Function to render the text inside the balloons
               */
               //TODO Make this bulletproof and create a way to get a default 'graph'
               balloonFunction: function(graphDataItem, amGraph){
                   if(typeof graphDataItem.values != 'undefined'){
                       return graphDataItem.category + "<br>" + graphDataItem.values.value.toFixed(2);
                   }else{
                       return "";
                   }
               },
               bullet: "round",
               bulletSize: 6,
               lineColor: "yellow",
               lineThickness: 1,
               negativeLineColor: "red",
               type: "smoothedLine",
               valueField: "phaseC"
           }],
           valueAxes: [{
               id: "phaseA-axis",
               title: " Phase A (Amps) ",
               position: "left",
               color: "green"
           },{
               id: "phaseB-axis",
               title: " Phase B (Amps) ",
               position: "right",
               color: "red"
           },{
               id: "phaseC-axis",
               title: " Phase C (Amps) ",
               position: "right",
               color: "yellow"
           }
           ],
           /*
           * End style of AmCharts
           */
       },{
       },{
           /*
           *Multi-series chart so create mappings from point to a graph valueField
           */
           dataPointMappings: [{
                   nameEndsWith: 'Phase A (A)',
                   valueField: 'phaseA' 
               },{
                   nameEndsWith: 'Phase B (A)',
                   valueField: 'phaseB'
               },{
                   nameEndsWith: 'Phase C (A)',
                   valueField: 'phaseC'
               }]
       });
       displayConfigurations.push(ampsChart);
       
       /**
       * Amps Bar Chart  w/Point Value Data Providers
       */
       var ampsBarChart = new BarChartConfiguration(
               'ampsBarChartDiv',
               /*
               * List of data provider Ids for this chart
               */
               [2,3,4],
                /**
                * Start AmChart Styling
                */
               {
                    "categoryField": "name",
                    "rotate": true,
                    "color": "whitesmoke",
					"startEffect": "bounce",
                   "graphs": [
                              {
                                  "balloonText": "Average:[[value]]",
                                  "fillAlphas": 0.8,
                                  "id": "AmGraph-1",
                                  "lineAlpha": 0.2,
                                  "title": "Total",
                                  "type": "column",
                                  "valueField": "value",
                                  "lineColor": "#CF000F"
                              }
                          ],
                          "guides": [],
                          "valueAxes": [
                              {
                                  "id": "ValueAxis-1",
                                  "position": "top",
                                  "axisAlpha": 0
                              }
                          ],
       },{//Empty Mango Chart Mixins
           categoryField: "name", //What member of the data point to use as category label/separator
       },{
       });
       displayConfigurations.push(ampsBarChart);
       
       /*
       * Voltage Bar Chart for use with Statistics Data Providers
       */
       var voltageChart = new  SerialChartConfiguration(
               'voltageChartDiv', //Chart DIV id
               /*
               * List of data provider Ids for this chart
               */
               [9,10,11],
               /**
               * Start AmChart Styling
               */
               {
                   "categoryField": "xid",
                   "color": "whitesmoke",
                   "startEffect": "bounce",
                   "graphs": [
                              {
                                  "balloonText": "Minimum:[[value]]",
                                  "fillAlphas": 0.8,
                                  "id": "AmGraph-1",
                                  "lineAlpha": 0.2,
                                  "title": "Minimum",
                                  "type": "column",
                                  "valueField": "minimum"
                              },
                              {
                                  "balloonText": "Maximum:[[value]]",
                                  "fillAlphas": 0.8,
                                  "id": "AmGraph-2",
                                  "lineAlpha": 0.2,
                                  "title": "Maximum",
                                  "type": "column",
                                  "valueField": "maximum"
                              },
                              {
                                  "balloonText": "Average:[[value]]",
                                  "fillAlphas": 0.8,
                                  "id": "AmGraph-3",
                                  "lineAlpha": 0.2,
                                  "title": "Average",
                                  "type": "column",
                                  "valueField": "average"
                              }
                          ],
                          "guides": [],
                          "titles": [
						{
							"id": "Title-1",
							"size": 15,
							"text": "Voltage"
						}
					],
                          "valueAxes": [
                              {
                                  "id": "ValueAxis-1",
                                  "position": "top",
                                  "axisAlpha": 0,
                                  "title": ""
                              }
                          ],
       },{//Empty Mango Chart Mixins
           categoryField: "xid", //What member of the data point to use as category label/separator
       },{
       });
       displayConfigurations.push(voltageChart);
       
       
           var kwhBarChart = new StatisticsBarChartConfiguration(
               'kwhBarChartDiv',
               /*
               * List of data provider Ids for this chart
               */
               [12,13,14],
               /**
               * Start AmChart Styling
               */
               {
                "categoryField": "name",
                "rotate": false,
                "color": "whitesmoke",
                  "graphs": [
                              {
                                  "balloonText": "Minimum:[[value]]",
                                  "fillAlphas": 0.8,
                                  "id": "AmGraph-1",
                                  "lineAlpha": 0.2,
                                  "title": "Minimum",
                                  "type": "column",
                                  "valueField": "minimum"
                              },
                              {
                                  "balloonText": "Maximum:[[value]]",
                                  "fillAlphas": 0.8,
                                  "id": "AmGraph-1",
                                  "lineAlpha": 0.2,
                                  "title": "Maximum",
                                  "type": "column",
                                  "valueField": "maximum"
                              },
                              {
                                  "balloonText": "Average:[[value]]",
                                  "fillAlphas": 0.8,
                                  "id": "AmGraph-2",
                                  "lineAlpha": 0.2,
                                  "title": "Average",
                                  "type": "column",
                                  "valueField": "average"
                              },
                               {
                                  "balloonText": "Integral:[[value]]",
                                  "fillAlphas": 0.8,
                                  "id": "AmGraph-3",
                                  "lineAlpha": 0.2,
                                  "title": "Integral",
                                  "type": "column",
                                  "valueField": "average"
                              },
                            {
                                  "balloonText": "Sum:[[value]]",
                                  "fillAlphas": 0.8,
                                  "id": "AmGraph-3",
                                  "lineAlpha": 0.2,
                                  "title": "Sum",
                                  "type": "column",
                                  "valueField": "average"
                              },
                          ],
                          
                          "guides": [],
                              "titles": [
						{
							"id": "Title-1",
							"size": 15,
							"text": "Statistics"
						}
					],
                          
                          
                          "valueAxes": [
                              {
                                  "id": "ValueAxis-1",
                                  "position": "top",
                                  "axisAlpha": 0,

                              }
                          ],
       },{//Empty Mango Chart Mixins
           categoryField: "name", //What member of the data point to use as category label/separator
       },{
       });
       displayConfigurations.push(kwhBarChart);




 var voltsBarChart = new BarChartConfiguration(
               'voltsBarChartDiv',
               /*
               * List of data provider Ids for this chart
               */
               [15,16,17], 
               /**
               * Start AmChart Styling
               */
               { //AmChart Mixins
                   "categoryField": "name",
                   "rotate": true,
                   "color": "whitesmoke",
                   "graphs": [
                              {
                                  "balloonText": "Average:[[value]]",
                                  "fillAlphas": 0.8,
                                  "id": "AmGraph-1",
                                  "lineAlpha": 0.2,
                                  "title": "Total",
                                  "type": "column",
                                  "valueField": "value",
                                  "lineColor": "#4183D7"
                              }
                          ],
                          "guides": [],
                          "valueAxes": [
                              {
                                  "id": "ValueAxis-1",
                                  "position": "top",
                                  "axisAlpha": 0
                              }
                          ],
       },{//Empty Mango Chart Mixins
           categoryField: "name", //What member of the data point to use as category label/separator
       },{
       });
       displayConfigurations.push(voltsBarChart);


var kwBarChart = new BarChartConfiguration(
               'kwBarChartDiv',
               /*
               * List of data provider Ids for this chart
               */
               [18,19,20],
               /**
               * Start AmChart Styling
               */
               {
                   "categoryField": "name",
                   "rotate": true,
                   "color":"whitesmoke",
                   "graphs": [
                              {
                                  "balloonText": "Average:[[value]]",
                                  "fillAlphas": 0.8,
                                  "id": "AmGraph-1",
                                  "lineAlpha": 0.2,
                                  "title": "Total",
                                  "type": "column",
                                  "valueField": "value"
                              }
                          ],
                          "guides": [],
                          "valueAxes": [
                              {
                                  "id": "ValueAxis-1",
                                  "position": "top",
                                  "axisAlpha": 0
                              }
                          ],
       },{//End AmChart Styles
       
           categoryField: "name", //What member of the data point to use as category label/separator
       },{
       });
       displayConfigurations.push(kwBarChart);


var powerFactorBarChart = new BarChartConfiguration(

               'powerFactorBarChartDiv',
                /*
                * List of data provider Ids for this chart
                */
               [21,22,23],
               /**
               * Start AmChart Styling
               */
               {
                   "categoryField": "name",
                   "rotate": true,
                   "color": "whitesmoke",
                   "graphs": [
                              {
                                  "balloonText": "Average:[[value]]",
                                  "fillAlphas": 0.8,
                                  "id": "AmGraph-1",
                                  "lineAlpha": 0.2,
                                  "title": "Total",
                                  "type": "column",
                                  "valueField": "value",
                                  "lineColor": "#A62B2B",
                              }
                          ],
                          "guides": [],
                          "valueAxes": [
                              {
                                  "id": "ValueAxis-1",
                                  "position": "top",
                                  "axisAlpha": 0
                              }
                          ],
       },{//end amcharts styles
       /**
       * this is the member of the data point to use as category label/separator
       * could be name xid or ?
       */
           categoryField: "name", 
       },{
       });
       displayConfigurations.push(powerFactorBarChart);

        /**
        * This is the Volts line chart that also shows statistics al
        */
       var voltsLineChart = new  SerialChartConfiguration(
               'voltsLineChartDiv', //Chart DIV id
               /*
               * List of data provider Ids for this chart
               */
               [24,25,26], 
            /**
            *AmChart Styles fo a chart.
            */
               {
           titles: [{
               id: "Title-1",
               size: 15,
               text: "Volts "
           }],
           categoryField: "timestamp",
           color: "whitesmoke",
           graphs: [{
               title: "Volts A-N",
               valueAxis: "voltsA-axis",
               /*
               *Function to render the text inside the balloons
               */
               //TODO Make this bulletproof and create a way to get a default 'graph'
               balloonFunction: function(graphDataItem, amGraph){
                   if(typeof graphDataItem.values != 'undefined'){
                       return graphDataItem.category + "<br>" + graphDataItem.values.value.toFixed(2);
                   }else{
                       return "";
                   }
               },
               bullet: "square",
               bulletSize: 6,
               lineColor: "green",
               lineThickness: 1,
               negativeLineColor: "red",
               type: "smoothedLine",
               valueField: "voltsA"
           },{              
               title: "Volts B-N",
               valueAxis: "voltsB-axis",
               /*
               *Function to render the text inside the balloons
               */
               //TODO Make this bulletproof and create a way to get a default 'graph'
               balloonFunction: function(graphDataItem, amGraph){
                   if(typeof graphDataItem.values != 'undefined'){
                       return graphDataItem.category + "<br>" + graphDataItem.values.value.toFixed(2);
                   }else{
                       return "";
                   }
               },
               bullet: "round",
               bulletSize: 6,
               lineColor: "red",
               lineThickness: 1,
               negativeLineColor: "red",
               type: "smoothedLine",
               valueField: "voltsB"
           },{              
               title: "Volts C-N",
               valueAxis: "voltsC-axis",
               /**
               * Function to render the text inside the balloons
               */
               //TODO Make this bulletproof and create a way to get a default 'graph'
               balloonFunction: function(graphDataItem, amGraph){
                   if(typeof graphDataItem.values != 'undefined'){
                       return graphDataItem.category + "<br>" + graphDataItem.values.value.toFixed(2);
                   }else{
                       return "";
                   }
               },
               bullet: "round",
               bulletSize: 6,
               lineColor: "yellow",
               lineThickness: 1,
               negativeLineColor: "red",
               type: "smoothedLine",
               valueField: "voltsC"
           }],
           valueAxes: [{
               id: "voltsA-axis",
               title: " Volts A-N ",
               position: "left",
               color: "green"
           },{
               id: "voltsB-axis",
               title: " Volts B-N ",
               position: "right",
               color: "red"
           },{
               id: "voltsC-axis",
               title: " Volts C-N ",
               position: "right",
               color: "yellow"
           }
           ],
       },{
       },{
           /*
           * Setting Multi-series chart to create mappings from point to a graph valueField
           */
           dataPointMappings: [{
                   nameEndsWith: 'Voltage A-N (V)',
                   valueField: 'voltsA' 
               },{
                   nameEndsWith: 'Voltage B-N (V)',
                   valueField: 'voltsB'
               },{
                   nameEndsWith: 'Voltage C-N (V)',
                   valueField: 'phaseC'
               }]
       });
       displayConfigurations.push(voltsLineChart);
       

// END THE CHARTS


       /**
       * Seting up the statistics Display for a different page on mobile.  This is different then on desktop due to the page stacking of are toolkits
       */
       displayConfigurations.push(
       
       new StatisticsConfiguration(
                'accumulator', 
                [5]
                )
       );
       
       displayConfigurations.push(
                new StatisticsConfiguration(
                'currentPhaseA',
                [6]
            )
        );  
       
       displayConfigurations.push(
                new StatisticsConfiguration(
                'currentPhaseB',
                [7]
            )
        );    
       
       displayConfigurations.push(
                new StatisticsConfiguration(
                'currentPhaseC',
                [8]
            )
        );    

       //Create Custom Data Provider To Compute kWh
       var dataProviders = new Array();
       var kwhDataProvider = new PointValueDataProvider(1, {manipulateData: function(pointValues, dataPoint){
           var newData = new Array();
           if(pointValues.length == 0)
               return newData;

           var previous = pointValues[0]
           //Subtract previous value from current.
           for(var i=1; i<pointValues.length; i++){
               var current = pointValues[i];
               var entry = {
                       value: current.value - previous.value,
                       timestamp: current.timestamp
               };
               newData.push(entry);
               
               //Move along
               previous = current;
           }
           
           return newData;
       }});
       dataProviders.push(kwhDataProvider);
       
       //Setup Point Configurations
       var pointConfigurations = new Array();

       
       
      
      /**
      *Kilo Watts per hour 
      */
       pointConfigurations.push(
                new DataPointMatchConfiguration(
                1, 
                [{ matchAttribute: 'name', regex: /.*\(kWh\)/}]
            )
       );

       pointConfigurations.push(
                new DataPointMatchConfiguration(
                2,
                [{matchAttribute: 'name', regex: /Phase A\ \(A\)/g}]
            )
        );
       
       
       pointConfigurations.push(
                new DataPointMatchConfiguration(
                3,
                [{matchAttribute: 'name', regex: /Phase\ B\ \(A\)/g}]
            )
       );
       


       pointConfigurations.push(
                new DataPointMatchConfiguration(
                4,
                [{matchAttribute: 'name', regex: /Phase\ C\(\A\)/g}]
                )
       );  
       
    
       pointConfigurations.push(
                new DataPointMatchConfiguration(
                5, 
                [{matchAttribute: 'name', regex: /.*\(kWh\)/, providerType: 'Statistics'}]
            )
        );



       pointConfigurations.push(
            new DataPointMatchConfiguration(
            6,
            [{matchAttribute: 'name',regex: /Phase\ \A\ \(A\)/g, providerType: 'Statistics'}]
                )
            )

       pointConfigurations.push(
            new DataPointMatchConfiguration(
            7,
            [{matchAttribute: 'name' , regex: /Phase\ \B\ \(\A\)/g , providerType: 'Statistics'}]
                )
            )

       pointConfigurations.push(
            new DataPointMatchConfiguration(
            8,
            [{matchAttribute: 'name' , regex: /\Phase\ C\ \(A\)/g, providerType: 'Statistics'}]
            )
        )

       pointConfigurations.push(
            new DataPointMatchConfiguration(
            9,
            [{matchAttribute:'name', regex: /Voltage\ \A-N\ \(V\)/g , providerType: 'Statistics'}]
            )
        )

       pointConfigurations.push(
                new DataPointMatchConfiguration(
                10,
                [{matchAttribute: 'name' ,regex: /Voltage\ B-N\ \(V\)/g, providerType: 'Statistics'}]
            )
        )

       pointConfigurations.push(
                new DataPointMatchConfiguration(
                11, 
                [{matchAttribute: 'name', regex: /Voltage\ C-N\ \(V\)/g , providerType: 'Statistics'}]
            )
       )

       pointConfigurations.push(
                new DataPointMatchConfiguration(
                12,
                [{matchAttribute: 'name' , regex: /kWh/g }],
                {providerType: 'Statistics'}
            )
       );

       pointConfigurations.push(
                new DataPointMatchConfiguration(
                13, 
                [{matchAttribute: 'name',regex: /\(kWh\)/g , providerType: 'Statistics'}]
            )
       );

       pointConfigurations.push(
                new DataPointMatchConfiguration(
                14, 
                [{matchAttribute: 'name' ,regex: /\(kWh\)/g,providerType: 'Statistics'}]
            )
       );

       pointConfigurations.push(
                new DataPointMatchConfiguration(
                15,
                [{matchAttribute: 'name' , regex: /Voltage\ A-N\ \(V\)/g }]
            )
       );

       pointConfigurations.push(
                new DataPointMatchConfiguration(
                16, 
                [{matchAttribute: 'name', regex: /Voltage\ B-N\ \(V\)/g}]
            )
       );

       pointConfigurations.push(
                new DataPointMatchConfiguration(
                17, 
                [{matchAttribute: 'name' , regex: /Voltage\ \C-N\ \(V\)/g}]
            )
       );

       pointConfigurations.push(
                new DataPointMatchConfiguration(
                18, 
                [{matchAttribute: 'name' , regex: /Real\ Power\ A\ \(kW\)/g }]
            )
       );

       pointConfigurations.push(
                new DataPointMatchConfiguration(
                19,
                [{matchAttribute: 'name' ,regex: /Real\ Power\ B\ \(kW\)/g}]
            )
       );

       pointConfigurations.push(
                new DataPointMatchConfiguration(
                20,
                [{matchAttribute:'name' , regex: /Real\ Power\ C\ \(kW\)/g}]
            )
        );

       
       pointConfigurations.push(
                new DataPointMatchConfiguration(
                21,
                [{matchAttribute: 'name', regex: /Power\ Factor\ A/g}]
            )
       );

       pointConfigurations.push(
                new DataPointMatchConfiguration(
                22,
                [{matchAttribute: 'name' , regex: /Power\ Factor\ B/g}]
            )
       );

       pointConfigurations.push(
                new DataPointMatchConfiguration(
                23, 
                [{matchAttribute: 'name' , regex: /Power\ Factor\ C/g }]
            )
       );

       pointConfigurations.push
                (new DataPointMatchConfiguration(
                24,
                [{matchAttribute: 'name' , regex: /Voltage\ A-N\ \(V\)/g }]
            )
       );
       
       pointConfigurations.push(
                new DataPointMatchConfiguration(
                25, 
                [{matchAttribute: 'name' , regex: /Voltage\ B-N\ \(V\)/g }]
            )
       );
       
       pointConfigurations.push(
                new DataPointMatchConfiguration(
                26,
                [{matchAttribute: 'name' , regex: /Voltage\ C-N\ \(V\)/g}]
            )
       );
       
       //Setup Groups
       
       var meterGroups = new DataPointGroupConfiguration({
           groupBy: 'Folder',
           labelAttribute: 'name',
           matchConfigurations: [{ matchAttribute: 'path' , regex: /.\/Buildings\/City\ Plex\/Meters\/M.*\ / }]
           }
           );
       
       
       /**
       * Setting up the Grouper Araary
       */
       var groupConfigurations = new Array();
       
       /**
       * Adding the Meters Group to the COnfig so that it can be passed off to the templater
       */
       groupConfigurations.push(meterGroups);
       
       /**
       *Create a custom grouper for jquery mobiles listview element
       */
       var groupListView = new ListViewConfiguration(
        'groupsList', 
        {},
        /*
        * Adding Custom Class tags to the object of the JQuery Mobiles ListView
        */
        {styleClass: "ui-btn ui-btn-icon-right  ui-icon-gear"}
        );
       
       /**
       *Setting upo the main Templater and adding all the vars ans what not to the Display
       */
       var templaterConfig = {
               debug: true,
               type: 'PointHierarchy',
               displayConfigurations: displayConfigurations,
               pointConfigurations: pointConfigurations,
               groupConfigurations: groupConfigurations,
               dataProviders: dataProviders,
               groupSelectConfiguration: groupListView,
       }
       
       templater = new DashboardTemplater(templaterConfig);
            
   });// End When page Ready
   
        /**
        * Display Errors method
        */
        function showError(jqXHR, textStatus, errorThrown, mangoMessage){
            var msg = "";
            if(textStatus != null)
                msg += (textStatus + " ");
            if(errorThrown != null)
                msg += (errorThrown + " ");
            if(mangoMessage != null)
                msg += (mangoMessage + " ");
            msg += "\n";
            $("#errors").text(msg);
        }
   </script>
</head>

<!-- Starting to write the UI -->

<body>

<div data-role="page" id="home">
    <div data-theme="a" data-role="header">
     <a href="#nav-panel" data-icon="bars">Meters</a>
     <a href="#help" data-transition="flip" class="ui-btn-icon-right" data-icon="info">Help</a>

<div class="mynav">
    <a data-transition="flip" class="ui-btn"  href="/private-dashboards/helloWorld.shtm">Hello World</a>
    <button class='navButton'>Page 2</button>
    <button class='navButton'>Page 3</button>
    <button class='navButton'>Page 4</button>
</div>

</div> <!--end the header-->

<div data-role="panel" data-theme="a" id="nav-panel">
    <ul class="navListView" data-role="listview" data-filter="true" data-rel="close" id="groupsList">
    </ul>
</div>

<!--This starts the main content of the page -->
<div data-role="main"  class="ui-content">


<!--The top left chart -->
<div class="barChartLeft">
        <h4>Amps</h4>
    <div id="ampsBarChartDiv" style="width:100%; height:200px; vertical-align: top;  display: inline-block; padding: 10px;"></div>
        <h4>Volts</h4> 
    <div id="voltsBarChartDiv" style="width:100%; height:200px; vertical-align: top;  display: inline-block; padding: 10px;"></div>
        <h4>Kilo Watts</h4>
    <div id="kwBarChartDiv" style="width:100%; height:200px; vertical-align: top;  display: inline-block; padding: 10px;"></div>
        <h4>Power Factor</h4>
    <div id="powerFactorBarChartDiv" style="width:100%; height:200px; vertical-align: top;  display: inline-block; padding: 10px;"></div>
</div> <!--The End of the top Left Chart -->


<!--The Top right chart -->
<div class="statsChart">
    <div id="kwhBarChartDiv" style="width:100%; height:400px; vertical-align: top;  display: inline-block; padding: 10px;"></div>
        <h3>KWH Watts Per Day</h3>
</div><!--End the top Right Chart -->


<!--The tabs for the charts  -->
<div id="tab" class="nav-tabs" class="lineChartTabs">
    <div  data-role="navbar" >
        <ul>
            <li onclick="templater.invalidateChartSize(['kwhChartDiv'], templater);"><a data-transition="flip" data-theme="a" href="#kw">KW</a>
            </li>
            <li onclick="templater.invalidateChartSize(['ampsChartDiv'], templater);"><a data-transition="fade" data-theme="a" href="#amps">Amps</a>
            </li>
            <li onclick="templater.invalidateChartSize(['voltsLineChartDiv'], templater);"><a onclick=""data-transition="fade" data-theme="a" href="#volts">Volts</a>
            </li>
        </ul>
</div>

<div id="kw">
    <div  id="kwhChartDiv" style="width:100% ; height:400px; vertical-align: top;  display: inline-block; padding: 10px;"></div>
</div>
<div id="amps">
    <div id="ampsChartDiv" style="width:100% ; height:400px; vertical-align: top;  display: inline-block; padding: 10px;"></div>
</div>
<div id="volts">
    <div id="voltsLineChartDiv" style="width:100% ; height:400px; vertical-align: top;  display: inline-block; padding: 10px;"></div>
</div>



<!-Starting the Rollup and date and time pickers-->
<div class="ui-grid-a">
<div data-role="navbar">
    <ul>
        <li>
        <div class="col-md-6 col-sm-3 placeholder">
            <input id="startDate"></input>
            <h4>Start Date</h4>
        </div>
        <div class="col-md-6 col-sm-3 placeholder">
            <input id="endDate"></input>
            <h4>End Date</h4>
        </div>
        </li>
        <li>
        <div class="ui-field-contain"  style="width=79%">
            <label for="rollup">Rollup:</label>
            <select id="rollup" class="form-control"></select>
        </div>
        </li>
        <li>
        <div class="ui-field-contain"  style="width=79%">
            <label for="timePeriodType">Time Period:</label>
            <select id="timePeriodType" class="form-control"></select>
        </div>
        <li>
        <div class="ui-field-contain"  style="width=79%">
            <label for="timePeriod">Periods:</label>
            <input id="timePeriod" type="number" value="1" class="form-control"/>
        </div>
        </li>
    </ul>
</div>
</div>
</div> <!--this is the end of the tabs-->

<div id="errors">
</div>

</div>


<div data-role="footer" data-theme="a">
    <h4>Powered by mango automation copyright 2014</h4>
</div><!-- /footer -->

</div> <!--The End Of Page One -->

<!--Start the acual Help page-->
<div data-role="page" id="help">
    <div data-theme="a" data-role="header"">
        <h3></h3>
        <h3>Help</h3>
        <a href="#home" data-icon="back" data-transition="flip">Back</a>
    </div><!-- /header -->

<div data-role="content">	
    <p>I'm the second in the source order so I'm hidden when the page loads. I'm just shown if a link that references my ID is beeing clicked.
    </p>
    <p>
    <a href="#foo">Back to foo
    </a>
    </p>
</div><!-- /content -->

<div data-role="footer" data-theme="a">
    <h4>Powered by mango automation copyright </script type="text/javascript">return new Date() </script></h4>
</div><!-- /footer -->
</div><!-- /help page -->
</body>
</html>
